// Vencord cb3bd4b
// Standalone: false
// Platform: win32
"use strict";var yt=Object.create;var Vr=Object.defineProperty;var wt=Object.getOwnPropertyDescriptor;var dt=Object.getOwnPropertyNames;var xt=Object.getPrototypeOf,St=Object.prototype.hasOwnProperty;var or=(r,t)=>()=>(r&&(t=r(r=0)),t);var Tt=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of dt(t))!St.call(r,i)&&i!==e&&Vr(r,i,{get:()=>t[i],enumerable:!(n=wt(t,i))||n.enumerable});return r};var Et=(r,t,e)=>(e=r!=null?yt(xt(r)):{},Tt(t||!r||!r.__esModule?Vr(e,"default",{value:r,enumerable:!0}):e,r));var h=or(()=>{"use strict"});function Dt(r){let t={};for(let e in r)t[e]=r[e],t[r[e]]=e;return Object.freeze(t)}var I,Ir=or(()=>{"use strict";h();I=Dt({QUICK_CSS_UPDATE:"VencordQuickCssUpdate",GET_QUICK_CSS:"VencordGetQuickCss",SET_QUICK_CSS:"VencordSetQuickCss",GET_SETTINGS_DIR:"VencordGetSettingsDir",GET_SETTINGS:"VencordGetSettings",SET_SETTINGS:"VencordSetSettings",OPEN_EXTERNAL:"VencordOpenExternal",OPEN_QUICKCSS:"VencordOpenQuickCss",GET_UPDATES:"VencordGetUpdates",GET_REPO:"VencordGetRepo",UPDATE:"VencordUpdate",BUILD:"VencordBuild",OPEN_MONACO_EDITOR:"VencordOpenMonacoEditor"})});function q(r){return async function(){try{return{ok:!0,value:await r(...arguments)}}catch(t){return{ok:!1,error:t instanceof Error?{...t}:t}}}}var Nr=or(()=>{"use strict";h()});var Zt={};function ar(...r){let t={cwd:Mr};return Ar?Cr("flatpak-spawn",["--host","git",...r],t):Cr("git",r,t)}async function zt(){return(await ar("remote","get-url","origin")).stdout.trim().replace(/git@(.+):/,"https://$1/").replace(/\.git$/,"")}async function Rt(){await ar("fetch");let t=(await ar("log","HEAD...origin/main","--pretty=format:%an/%h/%s")).stdout.trim();return t?t.split(`
`).map(e=>{let[n,i,...a]=e.split("/");return{hash:i,author:n,message:a.join("/")}}):[]}async function Gt(){return(await ar("pull")).stdout.includes("Fast-forward")}async function Pt(){return!(await Cr(Ar?"flatpak-spawn":"node",Ar?["--host","node","scripts/build/build.mjs"]:["scripts/build/build.mjs"],{cwd:Mr})).stderr.includes("Build failed")}var Ur,$,Wr,Lr,Mr,Cr,Ar,Br=or(()=>{"use strict";h();Ir();Ur=require("child_process"),$=require("electron"),Wr=require("path"),Lr=require("util");Nr();Mr=(0,Wr.join)(__dirname,".."),Cr=(0,Lr.promisify)(Ur.execFile),Ar=!1;$.ipcMain.handle(I.GET_REPO,q(zt));$.ipcMain.handle(I.GET_UPDATES,q(Rt));$.ipcMain.handle(I.UPDATE,q(Gt));$.ipcMain.handle(I.BUILD,q(Pt))});h();var N=require("electron"),It=require("path");h();h();Promise.resolve().then(()=>Br());h();Ir();h();var b=class{constructor(t=1/0){this.maxSize=t}queue=[];promise;next(){let t=this.queue.shift();t?this.promise=Promise.resolve().then(t).finally(()=>this.next()):this.promise=void 0}run(){this.promise||this.next()}push(t){this.size>=this.maxSize&&this.queue.shift(),this.queue.push(t),this.run()}unshift(t){this.size>=this.maxSize&&this.queue.pop(),this.queue.unshift(t),this.run()}get size(){return this.queue.length}};var C=require("electron"),tr=require("fs"),K=require("fs/promises"),_r=require("path");h();var Kr="PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KCjxoZWFkPgogICAgPG1ldGEgY2hhcnNldD0idXRmLTgiPgogICAgPHRpdGxlPlZlbmNvcmQgUXVpY2tDU1MgRWRpdG9yPC90aXRsZT4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgZGF0YS1uYW1lPSJ2cy9lZGl0b3IvZWRpdG9yLm1haW4iCiAgICAgICAgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbW9uYWNvLWVkaXRvci8wLjM0LjAvbWluL3ZzL2VkaXRvci9lZGl0b3IubWFpbi5taW4uY3NzIj4KICAgIDxzdHlsZT4KICAgICAgICBodG1sLAogICAgICAgIGJvZHksCiAgICAgICAgI2NvbnRhaW5lciB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgbGVmdDogMDsKICAgICAgICAgICAgdG9wOiAwOwogICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgICAgIHBhZGRpbmc6IDA7CiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICAgICAgfQogICAgPC9zdHlsZT4KPC9oZWFkPgoKPGJvZHk+CiAgICA8ZGl2IGlkPSJjb250YWluZXIiPjwvZGl2PgogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL21vbmFjby1lZGl0b3IvMC4zNC4wL21pbi92cy9sb2FkZXIubWluLmpzIj48L3NjcmlwdD4KCiAgICA8c2NyaXB0PgogICAgICAgIHJlcXVpcmUuY29uZmlnKHsgcGF0aHM6IHsgJ3ZzJzogJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL21vbmFjby1lZGl0b3IvMC4zNC4wL21pbi92cycgfSB9KTsKICAgICAgICByZXF1aXJlKFsidnMvZWRpdG9yL2VkaXRvci5tYWluIl0sICgpID0+IHsKICAgICAgICAgICAgZ2V0Q3VycmVudENzcygpLnRoZW4oY3NzID0+IHsKICAgICAgICAgICAgICAgIHZhciBlZGl0b3IgPSBtb25hY28uZWRpdG9yLmNyZWF0ZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGFpbmVyJyksIHsKICAgICAgICAgICAgICAgICAgICB2YWx1ZTogY3NzLAogICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlOiAnY3NzJywKICAgICAgICAgICAgICAgICAgICB0aGVtZTogZ2V0VGhlbWUoKSwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgZWRpdG9yLm9uRGlkQ2hhbmdlTW9kZWxDb250ZW50KCgpID0+CiAgICAgICAgICAgICAgICAgICAgc2V0Q3NzKGVkaXRvci5nZXRWYWx1ZSgpKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgLy8gbWFrZSBtb25hY28gcmUtbGF5b3V0CiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmxheW91dCgpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwoKCiAgICA8L3NjcmlwdD4KPC9ib2R5PgoKPC9odG1sPgo=";h();var jr=require("electron"),B=require("path"),yr=process.env.VENCORD_USER_DATA_DIR??(process.env.DISCORD_USER_DATA_DIR?(0,B.join)(process.env.DISCORD_USER_DATA_DIR,"..","VencordData"):(0,B.join)(jr.app.getPath("userData"),"..","Vencord")),rr=(0,B.join)(yr,"settings"),sr=(0,B.join)(rr,"quickCss.css"),wr=(0,B.join)(rr,"settings.json"),Hr=["https:","http:","steam:","spotify:"];(0,tr.mkdirSync)(rr,{recursive:!0});function Ot(){return(0,K.readFile)(sr,"utf-8").catch(()=>"")}function Yr(){try{return(0,tr.readFileSync)(wr,"utf-8")}catch{return"{}"}}function Qr(){try{return JSON.parse(Yr())}catch{return{}}}C.ipcMain.handle(I.OPEN_QUICKCSS,()=>C.shell.openPath(sr));C.ipcMain.handle(I.OPEN_EXTERNAL,(r,t)=>{try{var{protocol:e}=new URL(t)}catch{throw"Malformed URL"}if(!Hr.includes(e))throw"Disallowed protocol.";C.shell.openExternal(t)});var kt=new b,Ft=new b;C.ipcMain.handle(I.GET_QUICK_CSS,()=>Ot());C.ipcMain.handle(I.SET_QUICK_CSS,(r,t)=>kt.push(()=>(0,K.writeFile)(sr,t)));C.ipcMain.handle(I.GET_SETTINGS_DIR,()=>rr);C.ipcMain.on(I.GET_SETTINGS,r=>r.returnValue=Yr());C.ipcMain.handle(I.SET_SETTINGS,(r,t)=>{Ft.push(()=>(0,K.writeFile)(wr,t))});C.ipcMain.handle(I.OPEN_MONACO_EDITOR,async()=>{await new C.BrowserWindow({title:"Vencord QuickCSS Editor",autoHideMenuBar:!0,darkTheme:!0,webPreferences:{preload:(0,_r.join)(__dirname,"preload.js"),contextIsolation:!0,nodeIntegration:!1,sandbox:!1}}).loadURL(`data:text/html;base64,${Kr}`)});h();var pt=require("electron");h();var qr=require("module"),Vt=(0,qr.createRequire)("/"),ur,Nt=";var __w=require('worker_threads');__w.parentPort.on('message',function(m){onmessage({data:m})}),postMessage=function(m,t){__w.parentPort.postMessage(m,t)},close=process.exit;self=global";try{ur=Vt("worker_threads").Worker}catch{}var Ut=ur?function(r,t,e,n,i){var a=!1,s=new ur(r+Nt,{eval:!0}).on("error",function(f){return i(f,null)}).on("message",function(f){return i(null,f)}).on("exit",function(f){f&&!a&&i(new Error("exited with code "+f),null)});return s.postMessage(e,n),s.terminate=function(){return a=!0,ur.prototype.terminate.call(s)},s}:function(r,t,e,n,i){setImmediate(function(){return i(new Error("async operations unsupported - update to Node 12+ (or Node 10-11 with the --experimental-worker CLI flag)"),null)});var a=function(){};return{terminate:a,postMessage:a}},m=Uint8Array,k=Uint16Array,Sr=Uint32Array,Tr=new m([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Er=new m([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),$r=new m([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),br=function(r,t){for(var e=new k(31),n=0;n<31;++n)e[n]=t+=1<<r[n-1];for(var i=new Sr(e[30]),n=1;n<30;++n)for(var a=e[n];a<e[n+1];++a)i[a]=a-e[n]<<5|n;return[e,i]},rt=br(Tr,2),Dr=rt[0],Wt=rt[1];Dr[28]=258,Wt[258]=28;var tt=br(Er,0),et=tt[0],ze=tt[1],hr=new k(32768);for(l=0;l<32768;++l)R=(l&43690)>>>1|(l&21845)<<1,R=(R&52428)>>>2|(R&13107)<<2,R=(R&61680)>>>4|(R&3855)<<4,hr[l]=((R&65280)>>>8|(R&255)<<8)>>>1;var R,l,j=function(r,t,e){for(var n=r.length,i=0,a=new k(t);i<n;++i)r[i]&&++a[r[i]-1];var s=new k(t);for(i=0;i<t;++i)s[i]=s[i-1]+a[i-1]<<1;var f;if(e){f=new k(1<<t);var o=15-t;for(i=0;i<n;++i)if(r[i])for(var u=i<<4|r[i],c=t-r[i],v=s[r[i]-1]++<<c,S=v|(1<<c)-1;v<=S;++v)f[hr[v]>>>o]=u}else for(f=new k(n),i=0;i<n;++i)r[i]&&(f[i]=hr[s[r[i]-1]++]>>>15-r[i]);return f},er=new m(288);for(l=0;l<144;++l)er[l]=8;var l;for(l=144;l<256;++l)er[l]=9;var l;for(l=256;l<280;++l)er[l]=7;var l;for(l=280;l<288;++l)er[l]=8;var l,nt=new m(32);for(l=0;l<32;++l)nt[l]=5;var l;var it=j(er,9,1);var ot=j(nt,5,1),lr=function(r){for(var t=r[0],e=1;e<r.length;++e)r[e]>t&&(t=r[e]);return t},x=function(r,t,e){var n=t/8|0;return(r[n]|r[n+1]<<8)>>(t&7)&e},cr=function(r,t){var e=t/8|0;return(r[e]|r[e+1]<<8|r[e+2]<<16)>>(t&7)},at=function(r){return(r+7)/8|0},vr=function(r,t,e){(t==null||t<0)&&(t=0),(e==null||e>r.length)&&(e=r.length);var n=new(r.BYTES_PER_ELEMENT==2?k:r.BYTES_PER_ELEMENT==4?Sr:m)(e-t);return n.set(r.subarray(t,e)),n};var st=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],A=function(r,t,e){var n=new Error(t||st[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,A),!e)throw n;return n},ft=function(r,t,e){var n=r.length;if(!n||e&&e.f&&!e.l)return t||new m(0);var i=!t||e,a=!e||e.i;e||(e={}),t||(t=new m(n*3));var s=function(Or){var kr=t.length;if(Or>kr){var Fr=new m(Math.max(kr*2,Or));Fr.set(t),t=Fr}},f=e.f||0,o=e.p||0,u=e.b||0,c=e.l,v=e.d,S=e.m,G=e.n,_=n*8;do{if(!c){f=x(r,o,1);var F=x(r,o+1,3);if(o+=3,F)if(F==1)c=it,v=ot,S=9,G=5;else if(F==2){var Z=x(r,o,31)+257,U=x(r,o+10,15)+4,Y=Z+x(r,o+5,31)+1;o+=14;for(var V=new m(Y),Q=new m(19),g=0;g<U;++g)Q[$r[g]]=x(r,o+g*3,7);o+=U*3;for(var z=lr(Q),nr=(1<<z)-1,W=j(Q,z,1),g=0;g<Y;){var J=W[x(r,o,nr)];o+=J&15;var p=J>>>4;if(p<16)V[g++]=p;else{var L=0,ir=0;for(p==16?(ir=3+x(r,o,3),o+=2,L=V[g-1]):p==17?(ir=3+x(r,o,7),o+=3):p==18&&(ir=11+x(r,o,127),o+=7);ir--;)V[g++]=L}}var Gr=V.subarray(0,Z),O=V.subarray(Z);S=lr(Gr),G=lr(O),c=j(Gr,S,1),v=j(O,G,1)}else A(1);else{var p=at(o)+4,d=r[p-4]|r[p-3]<<8,P=p+d;if(P>n){a&&A(0);break}i&&s(u+d),t.set(r.subarray(p,P),u),e.b=u+=d,e.p=o=P*8,e.f=f;continue}if(o>_){a&&A(0);break}}i&&s(u+131072);for(var Ct=(1<<S)-1,At=(1<<G)-1,pr=o;;pr=o){var L=c[cr(r,o)&Ct],M=L>>>4;if(o+=L&15,o>_){a&&A(0);break}if(L||A(2),M<256)t[u++]=M;else if(M==256){pr=o,c=null;break}else{var Pr=M-254;if(M>264){var g=M-257,X=Tr[g];Pr=x(r,o,(1<<X)-1)+Dr[g],o+=X}var gr=v[cr(r,o)&At],mr=gr>>>4;gr||A(3),o+=gr&15;var O=et[mr];if(mr>3){var X=Er[mr];O+=cr(r,o)&(1<<X)-1,o+=X}if(o>_){a&&A(0);break}i&&s(u+131072);for(var Zr=u+Pr;u<Zr;u+=4)t[u]=t[u-O],t[u+1]=t[u+1-O],t[u+2]=t[u+2-O],t[u+3]=t[u+3-O];u=Zr}}e.l=c,e.p=pr,e.b=u,e.f=f,c&&(f=1,e.m=S,e.d=v,e.n=G)}while(!f);return u==t.length?t:vr(t,0,u)};var Lt=new m(0);var Mt=function(r,t){var e={};for(var n in r)e[n]=r[n];for(var n in t)e[n]=t[n];return e},Jr=function(r,t,e){for(var n=r(),i=r.toString(),a=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),s=0;s<n.length;++s){var f=n[s],o=a[s];if(typeof f=="function"){t+=";"+o+"=";var u=f.toString();if(f.prototype)if(u.indexOf("[native code]")!=-1){var c=u.indexOf(" ",8)+1;t+=u.slice(c,u.indexOf("(",c))}else{t+=u;for(var v in f.prototype)t+=";"+o+".prototype."+v+"="+f.prototype[v].toString()}else t+=u}else e[o]=f}return[t,e]},fr=[],Bt=function(r){var t=[];for(var e in r)r[e].buffer&&t.push((r[e]=new r[e].constructor(r[e])).buffer);return t},Kt=function(r,t,e,n){var i;if(!fr[e]){for(var a="",s={},f=r.length-1,o=0;o<f;++o)i=Jr(r[o],a,s),a=i[0],s=i[1];fr[e]=Jr(r[f],a,s)}var u=Mt({},fr[e][1]);return Ut(fr[e][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",e,u,Bt(u),n)},jt=function(){return[m,k,Sr,Tr,Er,$r,Dr,et,it,ot,hr,st,j,lr,x,cr,at,vr,A,ft,zr,ut,lt]};var ut=function(r){return postMessage(r,[r.buffer])},lt=function(r){return r&&r.size&&new m(r.size)},Ht=function(r,t,e,n,i,a){var s=Kt(e,n,i,function(f,o){s.terminate(),a(f,o)});return s.postMessage([r,t],t.consume?[r.buffer]:[]),function(){s.terminate()}};var E=function(r,t){return r[t]|r[t+1]<<8},T=function(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16|r[t+3]<<24)>>>0},dr=function(r,t){return T(r,t)+T(r,t+4)*4294967296};function _t(r,t,e){return e||(e=t,t={}),typeof e!="function"&&A(7),Ht(r,t,[jt],function(n){return ut(zr(n.data[0],lt(n.data[1])))},1,e)}function zr(r,t){return ft(r,t)}var xr=typeof TextDecoder<"u"&&new TextDecoder,Yt=0;try{xr.decode(Lt,{stream:!0}),Yt=1}catch{}var Qt=function(r){for(var t="",e=0;;){var n=r[e++],i=(n>127)+(n>223)+(n>239);if(e+i>r.length)return[t,vr(r,e-1)];i?i==3?(n=((n&15)<<18|(r[e++]&63)<<12|(r[e++]&63)<<6|r[e++]&63)-65536,t+=String.fromCharCode(55296|n>>10,56320|n&1023)):i&1?t+=String.fromCharCode((n&31)<<6|r[e++]&63):t+=String.fromCharCode((n&15)<<12|(r[e++]&63)<<6|r[e++]&63):t+=String.fromCharCode(n)}};function Jt(r,t){if(t){for(var e="",n=0;n<r.length;n+=16384)e+=String.fromCharCode.apply(null,r.subarray(n,n+16384));return e}else{if(xr)return xr.decode(r);var i=Qt(r),a=i[0],s=i[1];return s.length&&A(8),a}}var Xt=function(r,t){return t+30+E(r,t+26)+E(r,t+28)},qt=function(r,t,e){var n=E(r,t+28),i=Jt(r.subarray(t+46,t+46+n),!(E(r,t+8)&2048)),a=t+46+n,s=T(r,t+20),f=e&&s==4294967295?$t(r,a):[s,T(r,t+24),T(r,t+42)],o=f[0],u=f[1],c=f[2];return[E(r,t+10),o,u,i,a+E(r,t+30)+E(r,t+32),c]},$t=function(r,t){for(;E(r,t)!=1;t+=4+E(r,t+2));return[dr(r,t+12),dr(r,t+4),dr(r,t+20)]};var Xr=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(r){r()};function ct(r,t,e){e||(e=t,t={}),typeof e!="function"&&A(7);var n=[],i=function(){for(var p=0;p<n.length;++p)n[p]()},a={},s=function(p,d){Xr(function(){e(p,d)})};Xr(function(){s=e});for(var f=r.length-22;T(r,f)!=101010256;--f)if(!f||r.length-f>65558)return s(A(13,0,1),null),i;var o=E(r,f+8);if(o){var u=o,c=T(r,f+16),v=c==4294967295||u==65535;if(v){var S=T(r,f-12);v=T(r,S)==101075792,v&&(u=o=T(r,S+32),c=T(r,S+48))}for(var G=t&&t.filter,_=function(p){var d=qt(r,c,v),P=d[0],Z=d[1],U=d[2],Y=d[3],V=d[4],Q=d[5],g=Xt(r,Q);c=V;var z=function(W,J){W?(i(),s(W,null)):(J&&(a[Y]=J),--o||s(null,a))};if(!G||G({name:Y,size:Z,originalSize:U,compression:P}))if(!P)z(null,vr(r,g,g+Z));else if(P==8){var nr=r.subarray(g,g+Z);if(Z<32e4)try{z(null,zr(nr,new m(U)))}catch(W){z(W,null)}else n.push(_t(nr,{size:U},z))}else z(A(14,"unknown compression type "+P,1),null);else z(null,null)},F=0;F<u;++F)_(F)}else s(null,{});return i}var gt=require("fs"),D=require("fs/promises"),H=require("path");h();function ht(r){function t(s,f,o,u){let c=0;return c+=s<<0,c+=f<<8,c+=o<<16,c+=u<<24>>>0,c}if(r[0]===80&&r[1]===75&&r[2]===3&&r[3]===4)return r;if(r[0]!==67||r[1]!==114||r[2]!==50||r[3]!==52)throw new Error("Invalid header: Does not start with Cr24");let e=r[4]===3,n=r[4]===2;if(!n&&!e||r[5]||r[6]||r[7])throw new Error("Unexpected crx format version number.");if(n){let s=t(r[8],r[9],r[10],r[11]),f=t(r[12],r[13],r[14],r[15]),o=16+s+f;return r.subarray(o,r.length)}let a=12+t(r[8],r[9],r[10],r[11]);return r.subarray(a,r.length)}h();var vt=Et(require("https"));function Rr(r,t={}){return new Promise((e,n)=>{vt.default.get(r,t,i=>{let{statusCode:a,statusMessage:s,headers:f}=i;if(a>=400)return void n(`${a}: ${s} - ${r}`);if(a>=300)return void e(Rr(f.location,t));let o=[];i.on("error",n),i.on("data",u=>o.push(u)),i.once("end",()=>e(Buffer.concat(o)))})})}var bt=(0,H.join)(yr,"ExtensionCache");async function re(r,t){return await(0,D.mkdir)(t,{recursive:!0}),new Promise((e,n)=>{ct(r,(i,a)=>{if(i)return void n(i);Promise.all(Object.keys(a).map(async s=>{if(s.startsWith("_metadata/"))return;if(s.endsWith("/"))return void(0,D.mkdir)((0,H.join)(t,s),{recursive:!0});let f=s.split("/"),o=f.pop(),u=f.join("/"),c=(0,H.join)(t,u);u&&await(0,D.mkdir)(c,{recursive:!0}),await(0,D.writeFile)((0,H.join)(c,o),a[s])})).then(()=>e()).catch(s=>{(0,D.rm)(t,{recursive:!0,force:!0}),n(s)})})})}async function mt(r){let t=(0,H.join)(bt,`${r}`);try{await(0,D.access)(t,gt.constants.F_OK)}catch{let n=r==="fmkadmapgofadopljbjfkapdkoienihi"?"https://raw.githubusercontent.com/Vendicated/random-files/f6f550e4c58ac5f2012095a130406c2ab25b984d/fmkadmapgofadopljbjfkapdkoienihi.zip":`https://clients2.google.com/service/update2/crx?response=redirect&acceptformat=crx2,crx3&x=id%3D${r}%26uc&prodversion=32`,i=await Rr(n,{headers:{"User-Agent":"Vencord (https://github.com/Vendicated/Vencord)"}});await re(ht(i),t).catch(console.error)}pt.session.defaultSession.loadExtension(t)}N.app.whenReady().then(()=>{N.protocol.registerFileProtocol("vencord",({url:n},i)=>{let a=n.slice(10);switch(a.endsWith("/")&&(a=a.slice(0,-1)),a){case"renderer.js.map":case"vencordDesktopRenderer.js.map":case"preload.js.map":case"patcher.js.map":case"vencordDesktopMain.js.map":i((0,It.join)(__dirname,a));break;default:i({statusCode:403})}});try{Qr().enableReactDevtools&&mt("fmkadmapgofadopljbjfkapdkoienihi").then(()=>console.info("[Vencord] Installed React Developer Tools")).catch(n=>console.error("[Vencord] Failed to install React Developer Tools",n))}catch{}let r=n=>{let i={};return n.split(";").forEach(a=>{let[s,...f]=a.trim().split(/\s+/g);s&&!Object.prototype.hasOwnProperty.call(i,s)&&(i[s]=f)}),i},t=n=>Object.entries(n).filter(([,i])=>i?.length).map(i=>i.flat().join(" ")).join("; ");function e(n,i){if(i in n){let a=r(n[i][0]);for(let s of["style-src","connect-src","img-src","font-src","media-src","worker-src"])a[s]=["*","blob:","data:","'unsafe-inline'"];a["script-src"]??=[],a["script-src"].push("'unsafe-eval'","https://unpkg.com","https://cdnjs.cloudflare.com"),n[i]=[t(a)]}}N.session.defaultSession.webRequest.onHeadersReceived(({responseHeaders:n,resourceType:i},a)=>{n&&(i==="mainFrame"&&e(n,"content-security-policy"),i==="stylesheet"&&(n["content-type"]=["text/css"])),a({cancel:!1,responseHeaders:n})}),N.session.defaultSession.webRequest.onHeadersReceived=()=>{}});
//# sourceURL=VencordDesktopMain
//# sourceMappingURL=vencord://vencordDesktopMain.js.map
/*! For license information please see vencordDesktopMain.js.LEGAL.txt */
